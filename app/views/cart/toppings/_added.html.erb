<%= form_tag cart_toppings_add_path, remote: true, data:{calculate_url:cart_toppings_calulate_path} do %>
  <% if products %>
    <div id="added_carousel" class="carousel slide">
      <div class="carousel-inner">
        <% pages = Kaminari.paginate_array(products).page(1).per(5).total_pages %>
        <% (1..pages).each do |page| %>
          <div class="item <%= 'active' if page == 1 %>">
            <div class="row text-center">
              <% Kaminari.paginate_array(products).page(page).per(5).each_with_index do |topping, index| %>
                <div class="col-md-2 col-sm-2 <%= 'col-md-offset-1 col-sm-offset-1' if index == 0 %>">
                  <% cache ['topping_added', topping] do %>
                    <%= hidden_field_tag 'product_ids[]', topping.id %>
                    <div class="thumbnail">
                      <% if topping.photo.exists? %>
                        <%= image_tag topping.photo.url(:mini), class: 'img-responsive' %>
                      <% else %>
                        <img src="http://placehold.it/120x60/" alt="Slide1" class"img-responsive">
                      <% end %>
                      <h6><%= topping.name %></h6>
                      <a href="JavaScript:void(0);" class="btn btn-warning btn-xs remove"
                         role="button" data-id="<%= topping.id %>">
                        <i class="fa fa-spinner fa-spin" style="display:none;"></i>
                        <i class='glyphicon glyphicon-minus-sign'></i>
                        <%= number_to_currency topping.price %>
                      </a>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
      <div class="carousel-controls">
        <a class="carousel-control left" href="#added_carousel" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>
        <a class="right carousel-control" href="#added_carousel" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right"></span>
        </a>
      </div>
    </div>
  <% end %>
<% end %>